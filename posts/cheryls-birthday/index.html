<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Cheryl's Birthday | Pythonicity</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://coady.github.io/posts/cheryls-birthday/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="A. Coady">
<link rel="next" href="../fizz-buzz/" title="Fizz Buzz" type="text/html">
<meta property="og:site_name" content="Pythonicity">
<meta property="og:title" content="Cheryl's Birthday">
<meta property="og:url" content="https://coady.github.io/posts/cheryls-birthday/">
<meta property="og:description" content="How to solve the Cheryl's Birthday puzzle programmatically.¶
Albert and Bernard just became friends with Cheryl, and they want to know when her birthday is. Cheryl gave them a list of 10 possible date">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-03-20T00:00:00-07:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="../../">

            <span id="blog-title">Pythonicity</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav">
<li class="nav-item">
    <a href="index.ipynb" id="sourcelink" class="nav-link">Source</a>
    </li>


                    
            </ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>
                </li>
<li class="nav-item">
<a href="https://github.com/coady/coady.github.io" class="nav-link">Source</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Cheryl's Birthday</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    A. Coady
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2018-03-20T00:00:00-07:00" itemprop="datePublished" title="2018-03-20">2018-03-20</time></a>
            </p>
            
        <p class="sourceline"><a href="index.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-to-solve-the-Cheryl's-Birthday-puzzle-programmatically.">How to solve the <a href="https://en.wikipedia.org/wiki/Cheryl's_Birthday">Cheryl's Birthday</a> puzzle programmatically.<a class="anchor-link" href="#How-to-solve-the-Cheryl's-Birthday-puzzle-programmatically.">¶</a>
</h3>
<blockquote><ol>
<li>Albert and Bernard just became friends with Cheryl, and they want to know when her birthday is. Cheryl gave them a list of 10 possible dates:
<pre><code> May 15     May 16     May 19
June 17    June 18
July 14    July 16
August 14  August 15  August 17</code></pre>
</li>
<li>Cheryl then tells Albert and Bernard separately the month and the day of the birthday respectively.</li>
<li>Albert: I don't know when Cheryl's birthday is, but I know that Bernard does not know too.</li>
<li>Bernard: At first I don't know when Cheryl's birthday is, but I know now.</li>
<li>Albert: Then I also know when Cheryl's birthday is.</li>
<li>So when is Cheryl's birthday?</li>
</ol></blockquote>
<p>As with the <a href="https://github.com/norvig/pytudes/blob/master/ipynb/Cheryl.ipynb">pytudes solution</a>, the goal is to solve the puzzle in code.  A different approach is taken here though, for simplicity and extensibility.</p>
<p>The first step is to model the data.  A <code>set</code> of <code>Date</code> objects is suitable to represent the current possible dates.  Since <code>datetime.date</code> objects require a year, a minimal <code>collections.namedtuple</code> is used instead.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">NamedTuple</span>

<span class="n">DATES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'May 15'</span><span class="p">,</span>    <span class="s1">'May 16'</span><span class="p">,</span>    <span class="s1">'May 19'</span><span class="p">,</span>
        <span class="s1">'June 17'</span><span class="p">,</span>   <span class="s1">'June 18'</span><span class="p">,</span>
        <span class="s1">'July 14'</span><span class="p">,</span>   <span class="s1">'July 16'</span><span class="p">,</span>
      <span class="s1">'August 14'</span><span class="p">,</span> <span class="s1">'August 15'</span><span class="p">,</span> <span class="s1">'August 17'</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Date</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">month</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">day</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># pretty printing</span>
<span class="n">DATES</span> <span class="o">=</span> <span class="p">{</span><span class="n">Date</span><span class="p">(</span><span class="o">*</span><span class="n">date</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">DATES</span><span class="p">}</span>
<span class="n">DATES</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{August 14,
 August 15,
 August 17,
 July 14,
 July 16,
 June 17,
 June 18,
 May 15,
 May 16,
 May 19}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As is typical of these kinds of puzzles, it assumes all participants have perfect <a href="https://en.wikipedia.org/wiki/Theory_of_mind">Theory of Mind</a>.  That is, each participant making a statement is applying their private knowledge to what is publicly known, and assuming everyone else will do the same.  With that in mind, the claims made fall into 3 categories:</p>
<ul>
<li>I know ...</li>
<li>I don't know ...</li>
<li>They don't know ...</li>
</ul>
<p>The temporal variations "now" and "at first" can be modeled by the current set of dates.  Any claim then can be implemented functionally in this form:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">claim</span><span class="p">(</span><span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dates</span><span class="p">:</span> <span class="nb">set</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
    <span class="sd">"""Return subset of possible dates which would make the claim true.</span>
<span class="sd">    </span>
<span class="sd">    :param field: the field known by the claimant</span>
<span class="sd">    :param dates: the current set of dates publicly known</span>
<span class="sd">    """</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So what does it mean for Albert or Bernard to "know" the correct date?  It would mean applying their knowledge of the month or day leaves only one possibility.  The "I know ..." function therefore groups and filters for uniqueness.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">collections</span>

<span class="k">def</span> <span class="nf">known</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span>
    <span class="sd">"""Return subset of possible dates which would make the claim "I know ..." true."""</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">date</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span> <span class="k">if</span> <span class="n">counts</span><span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">field</span><span class="p">)]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">}</span>

<span class="c1"># test what is already publicly known</span>
<span class="k">assert</span> <span class="n">known</span><span class="p">(</span><span class="s1">'month'</span><span class="p">,</span> <span class="n">DATES</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">known</span><span class="p">(</span><span class="s1">'day'</span><span class="p">,</span> <span class="n">DATES</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{June 18, May 19}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To implement "I don't know ...", <code>known</code> could be parametrized with a different predicate (<code>&gt; 1</code>), or simply use  <code>set.difference</code>.  "I don't know ..." is so trivial it's arguably not worth the abstraction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">unknown</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span>
    <span class="sd">"""Return subset of possible dates which would make the claim "I don't know ..." true."""</span>
    <span class="k">return</span> <span class="n">dates</span> <span class="o">-</span> <span class="n">known</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">dates</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The challenging part is what does it mean for Albert to claim Bernard doesn't know.  All dates that would be knowable to Bernard must clearly be excluded, but Albert would have to exclude them based on his knowledge of the month.  So "They don't know ..." is similar to <code>unknown</code>, but the exclusion is based on a different field.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">unknowable</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span>
    <span class="sd">"""Return subset of possible dates which would make the claim "They don't know ..." true."""</span>
    <span class="n">other</span><span class="p">,</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">Date</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">field</span><span class="p">}</span>
    <span class="n">exclude</span> <span class="o">=</span> <span class="p">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">known</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">dates</span><span class="p">)}</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">date</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is sufficient to simply walk through the statements, one at a time.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Albert: I don't know when Cheryl's birthday is, but I know that Bernard does not know too.</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">unknown</span><span class="p">(</span><span class="s1">'month'</span><span class="p">,</span> <span class="n">DATES</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">dates</span> <span class="o">==</span> <span class="n">DATES</span>  <span class="c1"># already public known</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">unknowable</span><span class="p">(</span><span class="s1">'month'</span><span class="p">,</span> <span class="n">dates</span><span class="p">)</span>
<span class="n">dates</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{August 14, August 15, August 17, July 14, July 16}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Bernard: At first I don't know when Cheryl's birthday is, but I know now.</span>
<span class="k">assert</span> <span class="n">dates</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">known</span><span class="p">(</span><span class="s1">'day'</span><span class="p">,</span> <span class="n">DATES</span><span class="p">))</span>  <span class="c1"># already claimed by Albert</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">known</span><span class="p">(</span><span class="s1">'day'</span><span class="p">,</span> <span class="n">dates</span><span class="p">)</span>
<span class="n">dates</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{August 15, August 17, July 16}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Albert: Then I also know when Cheryl's birthday is.</span>
<span class="n">known</span><span class="p">(</span><span class="s1">'month'</span><span class="p">,</span> <span class="n">dates</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{July 16}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Exactly one date is left, indicating success.  Now the succinct in-lined version, with no superfluous statements.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">known</span><span class="p">(</span><span class="s1">'month'</span><span class="p">,</span>                        <span class="c1"># Albert: I know</span>
    <span class="n">known</span><span class="p">(</span><span class="s1">'day'</span><span class="p">,</span>                      <span class="c1"># Bernard: I know</span>
        <span class="n">unknowable</span><span class="p">(</span><span class="s1">'month'</span><span class="p">,</span> <span class="n">DATES</span><span class="p">)))</span>  <span class="c1"># Albert: Bernard doesn't know</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{July 16}</pre>
</div>

</div>

</div>
</div>

</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="next">
                <a href="../fizz-buzz/" rel="next" title="Fizz Buzz">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article><!--End of body content--><footer id="footer">
            Contents © 2020         <a href="mailto:aric.coady@gmail.com">A. Coady</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
